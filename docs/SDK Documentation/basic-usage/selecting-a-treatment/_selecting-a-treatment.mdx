import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";
import CodeBlock from "@theme/CodeBlock";

import JsSelectingATreatment from "!!raw-loader!./js/selectingATreatment.js";

import ReactSelectingATreatment from "!!raw-loader!./react/selectingATreatment.js";
import ReactUsingTernaryOperator from "!!raw-loader!./react/usingTernaryOperator.js";

import VueUsingTreatmentAlias from "!!raw-loader!./vue/UsingTreatmentAlias.vue";
import VueUsingTreatmentIndex from "!!raw-loader!./vue/UsingTreatmentIndex.vue";
import VueUsingOnlyDefaultSlot from "!!raw-loader!./vue/UsingOnlyDefaultSlot.vue";

import SwiftSelectingATreatment from "!!raw-loader!./swift/selectingATreatment.swift";

import JavaSelectingATreatment from "!!raw-loader!./java/selectingATreatment.java";

import GoSelectingATreatment from "!!raw-loader!./go/selectingATreatment.go";

import DotNetSelectingATreatment from "!!raw-loader!./dotnet/selectingATreatment.cs";

<Tabs groupId="language">

<TabItem value="js" label="Javascript">

:::info
To make sure the SDK is properly loaded before asking it for a treatment,
block your code until the SDK is ready as shown below.

The `ready()` method returns a promise. You can also just check if it is
currently ready with the `isReady()` method.

After the SDK is loaded you can use the `treatment()` method to return the proper
treatment based on the `experiment_name` and the units data that was passed when
the SDK was instantiated.

Then use an `if-else-if-else` block as shown below and insert the code for the
different treatments that you plan to create.
:::

<CodeBlock language="js">{JsSelectingATreatment}</CodeBlock>

</TabItem>

<TabItem value="react" label="React">

#### Using the Treatment component

In React, the easiest way to select your treatment is to use the `Treatment`
and `TreatmentVariant` components.

<CodeBlock language="jsx">{ReactSelectingATreatment}</CodeBlock>

:::note
If the loading prop is not provided the default variant will be shown instead.
:::

#### Using the ternary operator

If you need some more control over the way your variants are rendered, you can
use the `TreatmentFunction` component and the ternary operator, like so:

<CodeBlock language="jsx">{ReactUsingTernaryOperator}</CodeBlock>

</TabItem>

<Tabitem value="swift" label="Swift">

<!-- TODO: Add blocking of code before context is ready. -->

<CodeBlock language="swift">{SwiftSelectingATreatment}</CodeBlock>

</Tabitem>

<TabItem value="vue" label="Vue2">

The preferred method to select a treatment is using the `Treatment` component
with a named and scoped slot per treatment.

:::info The slot selection rules are as follows

- If the context is not ready:
  - If the loading slot exists, select it.
  - Otherwise, select the default slot.
- Otherwise, if the context is ready:
  - If a slot with the treatment alias (A, B, C, ...) exists, select it.
  - Otherwise, if a slot with the treatment index exists, select it.
  - Otherwise, select the default.
- If the selected slot doesn't exist, nothing will be rendered.

:::

**Example using the treatment alias**

<CodeBlock language="html">{VueUsingTreatmentAlias}</CodeBlock>

**Example using the treatment index**

<CodeBlock language="html">{VueUsingTreatmentIndex}</CodeBlock>

**Example using only the default slot**

<CodeBlock language="html">{VueUsingOnlyDefaultSlot}</CodeBlock>

:::info
The scoped slot properties contain information about the A/B Smartly context
and the selected treatment:

```json
{
  "treatment": 1,
  "config": {
    "color": "red"
  },
  "ready": true,
  "failed": false
}
```

If the experiment is not running, or the context creation failed, the slot
will be rendered with the following properties:

```json
{
  "treatment": 0,
  "config": {},
  "ready": true,
  "failed": false
}
```

:::

</TabItem>

<Tabitem value="java" label="Java">

<!-- TODO: Add blocking of code before context is ready. -->

<CodeBlock language="java">{JavaSelectingATreatment}</CodeBlock>

</Tabitem>

<Tabitem value="go" label="Go">

<!-- TODO: Add blocking of code before context is ready. -->

<CodeBlock language="go">{GoSelectingATreatment}</CodeBlock>

</Tabitem>

<TabItem value="dotnet" label=".NET">

<CodeBlock language="csharp">{DotNetSelectingATreatment}</CodeBlock>

</TabItem>

</Tabs>
